{% extends 'base.html.twig' %}

{% block body %}

<div class="overflow-hidden bg-white shadow sm:rounded-lg my-12 mx-36">
	<div class="px-4 py-5 sm:px-6">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900">A
            {{ service.disponibilites[0].service.name }}</h2>
        <h3 class="text-base font-semibold leading-6 text-gray-900">By
            {{ service.disponibilites[0].host.firstName }}
            {{ service.disponibilites[0].host.lastName }}</h3>
        <p>{{ service.categorie.name }}</p>
        <p class="mt-1 max-w-2xl text-sm text-gray-500">{{ service.description }}</p>
    </div>
    <div class="border-t border-gray-200">
	    <div class="px-36 py-12">
        <form method="post" accept-charset="UTF-8" action="{{ path('create_reservation') }}">

            <input id="flatpickr" type="text" placeholder="Select Date" data-categorie="{{ service.categorie.id }}" data-id="datetime" data-disponibilites-json="{{ disponibilitesJson }}" data-search-date-json = {{ searchDate }}>
            {# <input for="disponibilite" name="disponibilite" value="{{disponibilite.id}}" hidden> #}
            <input type="submit" value="Book this service" class="px-6 py-2 my-6 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-blue-600 rounded-lg hover:bg-blue-500 focus:outline-none focus:ring focus:ring-blue-300 focus:ring-opacity-80">
        
        </form>
        </div>
    </div>
</div>
	{# A faire: extrenaliser le code javascript pour ne pas le mélanger à twig #}
	{% block javascript %}

		<script>
			    const myInput = document.getElementById("flatpickr");
                const disponibilitesJson = document.getElementById("flatpickr").dataset.disponibilitesJson;
                const searchDateJson = document.getElementById("flatpickr").dataset.searchDateJson;
                console.log(searchDateJson);
                console.log(typeof(searchDateJson[0]))
                const idCategorie = document.getElementById("flatpickr").dataset.categorie;
                console.log(idCategorie);
                let jsonFP = {
                    dateFormat: "d-m-Y",
                    // minDate: "today",
                    enable: JSON.parse(disponibilitesJson),
                    inline: true,
                };

                if (idCategorie == 2) {
                    jsonFP.mode = "range";
                    jsonFP.defaultDate = [flatpickr.parseDate(searchDateJson[0], "Y-m-d"), flatpickr.parseDate(searchDateJson[1], "Y-m-d")];
                }
                else {
                    jsonFP.defaultDate = [flatpickr.parseDate(searchDateJson[0], "Y-m-d")]

                }
                const fp = flatpickr(myInput, jsonFP);
		</script>

	{% endblock %}
{% endblock %}
